package connect;

import java.sql.Connection;
import java.sql.DriverManager;

public class CustomerConnect {
    private static final String URL = "jdbc:mariadb://127.0.0.1:3306/retail_db";
    private static final String USER = "root";
    private static final String PASS = "1";

    public Connection getConnection() throws Exception {
        return DriverManager.getConnection(URL, USER, PASS);
    }

    public void addCustomer(int customerId, String customerFName, String customerLName, String customerEmail, String customerPassword) throws Exception {
        String sql = "INSERT INTO customers(customer_id, customer_fname, customer_lname, customer_email, customer_password) VALUES (?, ?, ?, ?, ?)";
        try (Connection conn = getConnection();
             java.sql.PreparedStatement ps = conn.prepareStatement(sql)) {
            ps.setInt(1, customerId);
            ps.setString(2, customerFName);
            ps.setString(3, customerLName);
            ps.setString(4, customerEmail);
            ps.setString(5, customerPassword);
            ps.executeUpdate();
        }
    }

    public void updateCustomer(int customerId, String customerFName, String customerLName, String customerEmail, String customerPassword) throws Exception {
        String sql = "UPDATE customers SET customer_fname = ?, customer_lname = ?, customer_email = ?, customer_password = ? WHERE customer_id = ?";
        try (Connection conn = getConnection();
             java.sql.PreparedStatement ps = conn.prepareStatement(sql)) {
            ps.setString(1, customerFName);
            ps.setString(2, customerLName);
            ps.setString(3, customerEmail);
            ps.setString(4, customerPassword);
            ps.setInt(5, customerId);
            ps.executeUpdate();
        }
    }

    public void deleteCustomer(int customerId) throws Exception {
        String sql = "DELETE FROM customers WHERE customer_id = ?";
        try (Connection conn = getConnection();
             java.sql.PreparedStatement ps = conn.prepareStatement(sql)) {
            ps.setInt(1, customerId);
            ps.executeUpdate();
        }
    }

    public void getCustomersTable() throws Exception {
        String sql = "SELECT * FROM customers";
        try (Connection conn = getConnection();
             java.sql.Statement stmt = conn.createStatement();
             java.sql.ResultSet rs = stmt.executeQuery(sql)) {
            while (rs.next()) {
                System.out.printf("| %-10d | %-15s | %-15s | %-25s | %-15s |\n",
                    rs.getInt("customer_id"),
                    rs.getString("customer_fname"),
                    rs.getString("customer_lname"),
                    rs.getString("customer_email"),
                    rs.getString("customer_password"));
            }
        }
    }

}
